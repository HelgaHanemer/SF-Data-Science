
# –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ä–µ–Ω—Ç–≥–µ–Ω–æ–≤—Å–∫–∏—Ö —Å–Ω–∏–º–∫–æ–≤ –ª—ë–≥–∫–∏—Ö (Normal / COVID / Viral Pneumonia)

–ü—Ä–æ–µ–∫—Ç —Ä–µ—à–∞–µ—Ç –∑–∞–¥–∞—á—É 3-–∫–ª–∞—Å—Å–æ–≤–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ä–µ–Ω—Ç–≥–µ–Ω–æ–≤—Å–∫–∏—Ö —Å–Ω–∏–º–∫–æ–≤ –≥—Ä—É–¥–Ω–æ–π –∫–ª–µ—Ç–∫–∏:
- **Normal**
- **COVID**
- **Viral Pneumonia**

–û—Å–Ω–æ–≤–Ω–æ–π –∞—Ä—Ç–µ—Ñ–∞–∫—Ç ‚Äî Jupyter-—Ç–µ—Ç—Ä–∞–¥—å —Å –ø–æ–ª–Ω–æ—Å—Ç—å—é –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º—ã–º –ø–∞–π–ø–ª–∞–π–Ω–æ–º:  
**`COVID_CXR_3class_classifier_PEP8.ipynb`** (PEP-8, –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ —Ç–∏–ø–æ–≤, –¥–æ–∫—Å—Ç—Ä–∏–Ω–≥–∏, –≤—ã–±–æ—Ä –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –ø–æ –≤–∞–ª–∏–¥–∞—Ü–∏–∏, —Ñ–∏–Ω–∞–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –Ω–∞ —Ç–µ—Å—Ç–µ, —ç–∫—Å–ø–æ—Ä—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π).

---

## üîß –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

- –°—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ä–∞–∑–±–∏–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ **train / val / test** (70/15/15).
- –ö–∞—Å—Ç–æ–º–Ω—ã–π **PyTorch Dataset** –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ **DataLoader‚Äô—ã** (shuffle —Ç–æ–ª—å–∫–æ –≤ train).
- –ú–æ–¥–µ–ª—å –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: **EfficientNet-B0** (transfer learning).
- –í–µ—Å–∞ –∫–ª–∞—Å—Å–æ–≤ (class weights) –¥–ª—è –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏ –¥–∏—Å–±–∞–ª–∞–Ω—Å–∞.
- –¶–∏–∫–ª—ã **–æ–±—É—á–µ–Ω–∏—è –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏** —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º `loss` –∏ `macro-F1`.
- **–í—ã–±–æ—Ä –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –ø–æ –≤–∞–ª–∏–¥–∞—Ü–∏–∏** (—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ `best.pt`), –∑–∞—Ç–µ–º ‚Äî –æ—Ü–µ–Ω–∫–∞ –Ω–∞ —Ç–µ—Å—Ç–µ.
- **–ú–µ—Ç—Ä–∏–∫–∏** –ø–æ –∫–∞–∂–¥–æ–º—É –∫–ª–∞—Å—Å—É –∏ —É—Å—Ä–µ–¥–Ω—ë–Ω–Ω—ã–µ (**precision / recall / F1**, `macro avg`).
- –≠–∫—Å–ø–æ—Ä—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π —Ç–µ—Å—Ç–∞ –≤ `checkpoints/test_predictions.csv`.
- –ü—Ä–µ—Å–µ—Ç—ã: **–±—ã—Å—Ç—Ä—ã–π** (smoke-test) –∏ **–±–æ–µ–≤–æ–π** (–¥–ª—è –ª—É—á—à–µ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞).

---

## üóÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö (—Ç—Ä–µ–±—É–µ–º–∞—è)

```
data/
 ‚îú‚îÄ Normal/
 ‚îú‚îÄ COVID/
 ‚îî‚îÄ Viral Pneumonia/
```
> –í–Ω—É—Ç—Ä–∏ ‚Äî –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (`.png/.jpg/.jpeg/.bmp`). –°–∫—Ä—ã—Ç—ã–µ —Ñ–∞–π–ª—ã –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è.

---

## üöÄ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å

### –í–∞—Ä–∏–∞–Ω—Ç A ‚Äî –ø–æ–ª–æ–∂–∏—Ç—å –¥–∞–Ω–Ω—ã–µ —Ä—è–¥–æ–º —Å —Ç–µ—Ç—Ä–∞–¥—å—é (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```
project/
 ‚îú‚îÄ COVID_CXR_3class_classifier_PEP8.ipynb
 ‚îî‚îÄ data/
     ‚îú‚îÄ Normal/
     ‚îú‚îÄ COVID/
     ‚îî‚îÄ Viral Pneumonia/
```
–¢–µ—Ç—Ä–∞–¥—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞–π–¥—ë—Ç `./data`.

### –í–∞—Ä–∏–∞–Ω—Ç B ‚Äî —É–∫–∞–∑–∞—Ç—å –ø—É—Ç—å –∫ –¥–∞—Ç–∞—Å–µ—Ç—É —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è
–í –Ω–∞—á–∞–ª–µ —Ç–µ—Ç—Ä–∞–¥–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
```python
import os
os.environ["DATA_ROOT"] = "C:/path/to/dataset"  # Windows
# os.environ["DATA_ROOT"] = "/home/user/dataset"  # Linux/macOS
```

---

## üíª –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```bash
pip install torch torchvision torchaudio  # –≤—ã–±–µ—Ä–∏—Ç–µ CPU/—Å–≤–æ–∏ CUDA-–±–∏–ª–¥—ã –Ω–∞ pytorch.org
pip install scikit-learn pillow matplotlib tqdm ipywidgets==8.* widgetsnbextension
# –¥–ª—è –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–≥–æ Jupyter: jupyter nbextension enable --py widgetsnbextension
```

---

## ‚öôÔ∏è –ü—Ä–µ—Å–µ—Ç—ã (–≤—Å—Ç—Ä–æ–µ–Ω—ã –≤ —Ç–µ—Ç—Ä–∞–¥—å)
```python
def use_quick_preset():
    # –ë—ã—Å—Ç—Ä—ã–π smoke-test
    CFG.img_size = 192
    CFG.batch_size = 32
    CFG.num_workers = 0
    CFG.epochs = 2

def use_full_preset():
    # –ë–æ–µ–≤–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ
    CFG.img_size = 224
    CFG.batch_size = 32
    CFG.num_workers = 2
    CFG.epochs = 15
```
–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω **–±—ã—Å—Ç—Ä—ã–π –ø—Ä–µ—Å–µ—Ç**. –î–ª—è ¬´–±–æ–µ–≤–æ–≥–æ¬ª –≤—ã–∑–æ–≤–∏—Ç–µ `use_full_preset()`.

---

## üß™ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≥–æ–Ω–∞ (–±—ã—Å—Ç—Ä—ã–π –ø—Ä–µ—Å–µ—Ç)

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:** EfficientNet-B0, `img_size=192`, `epochs=2`, `batch_size=32`, `num_workers=0`.  
**–í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ —ç–ø–æ—Ö–∞–º:**
- –≠–ø–æ—Ö–∞ 1 ‚Äî **Train:** loss=0.2013, macroF1=0.8876 | **Val:** loss=0.0838, macroF1=0.9416  
- –≠–ø–æ—Ö–∞ 2 ‚Äî **Train:** loss=0.0685, macroF1=0.9598 | **Val:** loss=0.0595, macroF1=0.9753  
**–°–æ—Ö—Ä–∞–Ω—ë–Ω –ª—É—á—à–∏–π —á–µ–∫–ø–æ–∏–Ω—Ç:** `checkpoints/best.pt` (–ø–æ –≤–∞–ª–∏–¥–∞—Ü–∏–∏).

**–¢–µ—Å—Ç:** **macro avg F1 = 0.9798**  
(–û—Ç—á—ë—Ç –ø–æ –∫–ª–∞—Å—Å–∞–º –∏ confusion matrix ‚Äî —Å–º. —Ä–∞–∑–¥–µ–ª 9 —Ç–µ—Ç—Ä–∞–¥–∏; –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è: `checkpoints/test_predictions.csv`).

**–ö—Ä–∞—Ç–∫–∏–π –≤—ã–≤–æ–¥:** –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è –Ω–µ –Ω–∞–±–ª—é–¥–∞–µ—Ç—Å—è (–∫—Ä–∏–≤—ã–µ train/val —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω—ã, —Ä–∞–∑—Ä—ã–≤ –Ω–µ —Ä–∞—Å—Ç—ë—Ç). –†–µ–∑—É–ª—å—Ç–∞—Ç —É—Å—Ç–æ–π—á–∏–≤—ã–π –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ä–µ–∂–∏–º–∞; –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è ‚Äî –∑–∞–ø—É—Å—Ç–∏—Ç—å ¬´–±–æ–µ–≤–æ–π¬ª –ø—Ä–µ—Å–µ—Ç –∏/–∏–ª–∏ k-fold CV.

---

## ‚úÖ –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –∫—Ä–∏—Ç–µ—Ä–∏—è–º

1) –†–∞–∑–±–∏–µ–Ω–∏–µ **train/val/test** —Å–æ —Å—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π ‚Äî —Ä–∞–∑–¥–µ–ª 2 —Ç–µ—Ç—Ä–∞–¥–∏.  
2) **PyTorch Dataset** ‚Äî —Ä–∞–∑–¥–µ–ª 3 (`CXRDataset`).  
3) **DataLoader‚Äô—ã** ‚Äî shuffle **—Ç–æ–ª—å–∫–æ** –≤ train ‚Äî —Ä–∞–∑–¥–µ–ª 4.  
4) **–¶–∏–∫–ª—ã –æ–±—É—á–µ–Ω–∏—è/–≤–∞–ª–∏–¥–∞—Ü–∏–∏** ‚Äî –≤–∞–ª–∏–¥–∞—Ü–∏—è **–≤ –∫–∞–∂–¥–æ–π —ç–ø–æ—Ö–µ** ‚Äî —Ä–∞–∑–¥–µ–ª 7.  
5) **–ú–æ–¥–µ–ª—å –æ–±—É—á–µ–Ω–∞** ‚Äî —Ä–∞–∑–¥–µ–ª—ã 5‚Äì7.  
6) **–í—ã–±–æ—Ä –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ –ø–æ –≤–∞–ª–∏–¥–∞—Ü–∏–∏** (—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ `best.pt`, –Ω–µ –ø–æ —Ç–µ—Å—Ç—É) ‚Äî —Ä–∞–∑–¥–µ–ª 7.  
7) **–ú–µ—Ç—Ä–∏–∫–∏ –Ω–∞ —Ç–µ—Å—Ç–µ** ‚Äî per-class + macro avg (precision/recall/F1) ‚Äî —Ä–∞–∑–¥–µ–ª 9.  
8) –¶–µ–ª—å **macro avg F1 ‚â• 0.8** ‚Äî –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–∞ (0.9798).

---

## üìå –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ø–æ–≤—ã—à–µ–Ω–∏—é –∫–∞—á–µ—Å—Ç–≤–∞

- –£–≤–µ–ª–∏—á–∏—Ç—å `img_size` –¥–æ 224‚Äì256 –∏ `epochs` –¥–æ 15‚Äì25 (—Å **early stopping**).
- –£—Å–∏–ª–∏—Ç—å –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏: `RandomResizedCrop`, –ª—ë–≥–∫–∏–π `ColorJitter`, `GaussianBlur`.
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –Ω–∞ ¬´—à–æ—Ä—Ç–∫–∞—Ç—ã¬ª (–Ω–∞–¥–ø–∏—Å–∏ *R/L*, –¥–∞—Ç—ã, –≤–æ–¥—è–Ω—ã–µ –∑–Ω–∞–∫–∏) –∏ –±–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤.
- –ü—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ ID –ø–∞—Ü–∏–µ–Ω—Ç–æ–≤ ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **patient-level split**.
- –ü—Ä–æ–≥–Ω–∞—Ç—å —Å —Ä–∞–∑–Ω—ã–º–∏ `SEED`, —Å–¥–µ–ª–∞—Ç—å **5-fold CV**.
